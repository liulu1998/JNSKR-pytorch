2021-01-31 19:33:46,585 - root - INFO - Namespace(Ks='[10, 20, 40]', batch_size=256, c0=1000, c1=7000, coefficient=[1.0, 0.01], data_name='yelp2018', data_root='./data', dropout=[0.8, 0.7], dropout_cf=0.3, dropout_kg=0.1, embed_size=64, epochs=105, evaluate_every=5, lambda_bilinear=[1e-05, 1], lr=0.05, p=0.5, save_dir='./log/JNSKR/yelp2018/emb_size64_lr0.05/', sparsity=0, stop_patience=20, test_batch_size=128, weight=None, weight_l2=1e-05)
2021-01-31 19:34:00,791 - root - INFO - start to train, 105 epochs in all
2021-01-31 19:34:07,133 - root - INFO - epoch 1 train loss: -930.267584
2021-01-31 19:34:12,460 - root - INFO - epoch 2 train loss: -1310.302465
2021-01-31 19:34:17,690 - root - INFO - epoch 3 train loss: -1445.490049
2021-01-31 19:34:22,750 - root - INFO - epoch 4 train loss: -1536.463115
2021-01-31 19:34:27,954 - root - INFO - epoch 5 train loss: -1606.893119
2021-01-31 19:34:27,954 - root - INFO - epoch 5 evaluating ...
2021-01-31 19:36:26,225 - root - INFO -     [test] epoch 5 Recall @10: 0.035307159248248204 @20: 0.059164929442818856 @40: 0.09629445824123987
2021-01-31 19:36:26,226 - root - INFO -     [test] epoch 5 NDCG @10: 0.06477231848724715 @20: 0.08751871753447345 @40: 0.11672426971131536
2021-01-31 19:36:31,190 - root - INFO - epoch 6 train loss: -1663.342144
2021-01-31 19:36:36,545 - root - INFO - epoch 7 train loss: -1709.726330
2021-01-31 19:36:41,849 - root - INFO - epoch 8 train loss: -1748.355981
2021-01-31 19:36:47,249 - root - INFO - epoch 9 train loss: -1781.624093
2021-01-31 19:36:52,637 - root - INFO - epoch 10 train loss: -1808.310571
2021-01-31 19:36:52,638 - root - INFO - epoch 10 evaluating ...
2021-01-31 19:38:47,986 - root - INFO -     [test] epoch 10 Recall @10: 0.039994409797951776 @20: 0.06678692668287808 @40: 0.10774774005929692
2021-01-31 19:38:47,986 - root - INFO -     [test] epoch 10 NDCG @10: 0.07237488520379412 @20: 0.09721200841952908 @40: 0.12905611586118032
2021-01-31 19:38:52,745 - root - INFO - epoch 11 train loss: -1831.005657
2021-01-31 19:38:58,853 - root - INFO - epoch 12 train loss: -1851.000415
2021-01-31 19:39:04,177 - root - INFO - epoch 13 train loss: -1868.655316
2021-01-31 19:39:09,899 - root - INFO - epoch 14 train loss: -1882.686636
2021-01-31 19:39:15,691 - root - INFO - epoch 15 train loss: -1894.760627
2021-01-31 19:39:15,692 - root - INFO - epoch 15 evaluating ...
2021-01-31 19:41:14,680 - root - INFO -     [test] epoch 15 Recall @10: 0.042657795102644176 @20: 0.07055640374121888 @40: 0.11389260535804197
2021-01-31 19:41:14,680 - root - INFO -     [test] epoch 15 NDCG @10: 0.07596144108343035 @20: 0.10190448846657968 @40: 0.1352490155232839
2021-01-31 19:41:20,020 - root - INFO - epoch 16 train loss: -1906.425616
2021-01-31 19:41:25,563 - root - INFO - epoch 17 train loss: -1916.631444
2021-01-31 19:41:31,034 - root - INFO - epoch 18 train loss: -1925.115468
2021-01-31 19:41:35,955 - root - INFO - epoch 19 train loss: -1932.295733
2021-01-31 19:41:41,493 - root - INFO - epoch 20 train loss: -1939.277988
2021-01-31 19:41:41,493 - root - INFO - epoch 20 evaluating ...
2021-01-31 19:43:44,140 - root - INFO -     [test] epoch 20 Recall @10: 0.044273741377705525 @20: 0.07238073433911887 @40: 0.11614789917472296
2021-01-31 19:43:44,141 - root - INFO -     [test] epoch 20 NDCG @10: 0.07835989045882921 @20: 0.10462193341426543 @40: 0.13826736832077563
2021-01-31 19:43:49,794 - root - INFO - epoch 21 train loss: -1945.463036
2021-01-31 19:43:55,726 - root - INFO - epoch 22 train loss: -1951.371512
2021-01-31 19:44:01,024 - root - INFO - epoch 23 train loss: -1955.666940
2021-01-31 19:44:06,118 - root - INFO - epoch 24 train loss: -1960.654497
2021-01-31 19:44:12,090 - root - INFO - epoch 25 train loss: -1964.301923
2021-01-31 19:44:12,090 - root - INFO - epoch 25 evaluating ...
2021-01-31 19:46:08,951 - root - INFO -     [test] epoch 25 Recall @10: 0.04443153856366274 @20: 0.07323868544503621 @40: 0.11814847856984724
2021-01-31 19:46:08,951 - root - INFO -     [test] epoch 25 NDCG @10: 0.07933261729018835 @20: 0.10611036080598892 @40: 0.14058660269976472
2021-01-31 19:46:13,957 - root - INFO - epoch 26 train loss: -1967.993859
2021-01-31 19:46:19,613 - root - INFO - epoch 27 train loss: -1972.126404
2021-01-31 19:46:25,086 - root - INFO - epoch 28 train loss: -1975.671320
2021-01-31 19:46:30,756 - root - INFO - epoch 29 train loss: -1978.156587
2021-01-31 19:46:36,167 - root - INFO - epoch 30 train loss: -1981.251469
2021-01-31 19:46:36,167 - root - INFO - epoch 30 evaluating ...
2021-01-31 19:48:35,583 - root - INFO -     [test] epoch 30 Recall @10: 0.04484321034601033 @20: 0.07383462830839475 @40: 0.11817410244585208
2021-01-31 19:48:35,583 - root - INFO -     [test] epoch 30 NDCG @10: 0.0798119842986816 @20: 0.10669599959251928 @40: 0.14078794259059968
2021-01-31 19:48:41,765 - root - INFO - epoch 31 train loss: -1984.737654
2021-01-31 19:48:47,525 - root - INFO - epoch 32 train loss: -1985.922893
2021-01-31 19:48:53,157 - root - INFO - epoch 33 train loss: -1989.708308
2021-01-31 19:48:58,326 - root - INFO - epoch 34 train loss: -1990.170654
2021-01-31 19:49:04,205 - root - INFO - epoch 35 train loss: -1993.491186
2021-01-31 19:49:04,205 - root - INFO - epoch 35 evaluating ...
2021-01-31 19:51:08,055 - root - INFO -     [test] epoch 35 Recall @10: 0.04472120898213764 @20: 0.07426367342638844 @40: 0.1189897022065804
2021-01-31 19:51:08,055 - root - INFO -     [test] epoch 35 NDCG @10: 0.07949285010960992 @20: 0.10672520504323586 @40: 0.14097126173550717
2021-01-31 19:51:13,579 - root - INFO - epoch 36 train loss: -1995.893441
2021-01-31 19:51:18,900 - root - INFO - epoch 37 train loss: -1996.860202
2021-01-31 19:51:24,265 - root - INFO - epoch 38 train loss: -1998.019226
2021-01-31 19:51:29,789 - root - INFO - epoch 39 train loss: -2000.972463
2021-01-31 19:51:35,333 - root - INFO - epoch 40 train loss: -2003.083022
2021-01-31 19:51:35,334 - root - INFO - epoch 40 evaluating ...
2021-01-31 19:53:31,771 - root - INFO -     [test] epoch 40 Recall @10: 0.04535732709183084 @20: 0.07481814220129837 @40: 0.11938794604599325
2021-01-31 19:53:31,772 - root - INFO -     [test] epoch 40 NDCG @10: 0.08051362901971784 @20: 0.10772327618599152 @40: 0.14181822715699477
2021-01-31 19:53:36,904 - root - INFO - epoch 41 train loss: -2002.542076
2021-01-31 19:53:42,319 - root - INFO - epoch 42 train loss: -2005.137121
2021-01-31 19:53:47,838 - root - INFO - epoch 43 train loss: -2005.525608
2021-01-31 19:53:53,933 - root - INFO - epoch 44 train loss: -2007.667642
2021-01-31 19:53:59,068 - root - INFO - epoch 45 train loss: -2008.958204
2021-01-31 19:53:59,068 - root - INFO - epoch 45 evaluating ...
2021-01-31 19:55:58,393 - root - INFO -     [test] epoch 45 Recall @10: 0.04534012898973928 @20: 0.07499347248168149 @40: 0.12016775581356742
2021-01-31 19:55:58,394 - root - INFO -     [test] epoch 45 NDCG @10: 0.08033392306151033 @20: 0.10774142209324282 @40: 0.14233594060372248
2021-01-31 19:56:03,257 - root - INFO - epoch 46 train loss: -2010.279887
2021-01-31 19:56:08,171 - root - INFO - epoch 47 train loss: -2010.075863
2021-01-31 19:56:14,345 - root - INFO - epoch 48 train loss: -2012.012403
2021-01-31 19:56:19,726 - root - INFO - epoch 49 train loss: -2013.262722
2021-01-31 19:56:24,654 - root - INFO - epoch 50 train loss: -2014.503539
2021-01-31 19:56:24,654 - root - INFO - epoch 50 evaluating ...
2021-01-31 19:58:21,215 - root - INFO -     [test] epoch 50 Recall @10: 0.045499771902171415 @20: 0.07498081931356322 @40: 0.12048111759847017
2021-01-31 19:58:21,216 - root - INFO -     [test] epoch 50 NDCG @10: 0.08076281889846536 @20: 0.10805895499046145 @40: 0.1425790252542835
2021-01-31 19:58:26,536 - root - INFO - epoch 51 train loss: -2014.613211
2021-01-31 19:58:31,493 - root - INFO - epoch 52 train loss: -2015.327478
2021-01-31 19:58:37,110 - root - INFO - epoch 53 train loss: -2017.539683
2021-01-31 19:58:42,644 - root - INFO - epoch 54 train loss: -2018.174598
2021-01-31 19:58:48,180 - root - INFO - epoch 55 train loss: -2018.466915
2021-01-31 19:58:48,180 - root - INFO - epoch 55 evaluating ...
2021-01-31 20:00:50,461 - root - INFO -     [test] epoch 55 Recall @10: 0.04570517499860224 @20: 0.0752650768210996 @40: 0.12096868820990951
2021-01-31 20:00:50,461 - root - INFO -     [test] epoch 55 NDCG @10: 0.08111232524889028 @20: 0.10851759077300735 @40: 0.14322770294370457
2021-01-31 20:00:56,488 - root - INFO - epoch 56 train loss: -2019.869166
2021-01-31 20:01:01,906 - root - INFO - epoch 57 train loss: -2021.051658
2021-01-31 20:01:07,186 - root - INFO - epoch 58 train loss: -2021.307801
2021-01-31 20:01:12,593 - root - INFO - epoch 59 train loss: -2020.674791
2021-01-31 20:01:18,079 - root - INFO - epoch 60 train loss: -2022.780367
2021-01-31 20:01:18,079 - root - INFO - epoch 60 evaluating ...
2021-01-31 20:03:15,931 - root - INFO -     [test] epoch 60 Recall @10: 0.04529204584745025 @20: 0.07498920015421005 @40: 0.12085786179207782
2021-01-31 20:03:15,932 - root - INFO -     [test] epoch 60 NDCG @10: 0.08082069447087488 @20: 0.10811927115438692 @40: 0.14302144596737779
2021-01-31 20:03:21,965 - root - INFO - epoch 61 train loss: -2022.674773
2021-01-31 20:03:27,439 - root - INFO - epoch 62 train loss: -2024.250825
2021-01-31 20:03:33,476 - root - INFO - epoch 63 train loss: -2024.775217
2021-01-31 20:03:38,688 - root - INFO - epoch 64 train loss: -2025.065049
2021-01-31 20:03:43,787 - root - INFO - epoch 65 train loss: -2025.162164
2021-01-31 20:03:43,787 - root - INFO - epoch 65 evaluating ...
2021-01-31 20:05:40,380 - root - INFO -     [test] epoch 65 Recall @10: 0.04565257908811345 @20: 0.07540737448758617 @40: 0.12122424530345102
2021-01-31 20:05:40,381 - root - INFO -     [test] epoch 65 NDCG @10: 0.08111772708521102 @20: 0.10866265716530937 @40: 0.14341352244007557
2021-01-31 20:05:45,958 - root - INFO - epoch 66 train loss: -2025.941675
2021-01-31 20:05:52,932 - root - INFO - epoch 67 train loss: -2028.162413
2021-01-31 20:06:00,230 - root - INFO - epoch 68 train loss: -2028.047425
2021-01-31 20:06:05,845 - root - INFO - epoch 69 train loss: -2028.466184
2021-01-31 20:06:11,532 - root - INFO - epoch 70 train loss: -2029.519128
2021-01-31 20:06:11,532 - root - INFO - epoch 70 evaluating ...
2021-01-31 20:08:05,651 - root - INFO -     [test] epoch 70 Recall @10: 0.04545285392698314 @20: 0.07519769785850203 @40: 0.12104835008405058
2021-01-31 20:08:05,652 - root - INFO -     [test] epoch 70 NDCG @10: 0.08071788823138824 @20: 0.10817878675102588 @40: 0.14313072678169497
2021-01-31 20:08:11,117 - root - INFO - epoch 71 train loss: -2029.892744
2021-01-31 20:08:16,024 - root - INFO - epoch 72 train loss: -2029.198657
2021-01-31 20:08:22,249 - root - INFO - epoch 73 train loss: -2030.486528
2021-01-31 20:08:27,676 - root - INFO - epoch 74 train loss: -2030.886580
2021-01-31 20:08:32,742 - root - INFO - epoch 75 train loss: -2031.847376
2021-01-31 20:08:32,742 - root - INFO - epoch 75 evaluating ...
2021-01-31 20:10:23,507 - root - INFO -     [test] epoch 75 Recall @10: 0.04534271715086264 @20: 0.07554504757697628 @40: 0.12091643697010916
2021-01-31 20:10:23,507 - root - INFO -     [test] epoch 75 NDCG @10: 0.08084844654242389 @20: 0.10862446680266535 @40: 0.1432644195812579
2021-01-31 20:10:28,873 - root - INFO - epoch 76 train loss: -2031.420569
2021-01-31 20:10:34,335 - root - INFO - epoch 77 train loss: -2032.341693
2021-01-31 20:10:39,625 - root - INFO - epoch 78 train loss: -2032.387067
2021-01-31 20:10:45,058 - root - INFO - epoch 79 train loss: -2032.071951
2021-01-31 20:10:50,203 - root - INFO - epoch 80 train loss: -2033.894773
2021-01-31 20:10:50,204 - root - INFO - epoch 80 evaluating ...
2021-01-31 20:12:39,937 - root - INFO -     [test] epoch 80 Recall @10: 0.04567519807785124 @20: 0.07568781033433719 @40: 0.12104470210359901
2021-01-31 20:12:39,937 - root - INFO -     [test] epoch 80 NDCG @10: 0.08093172642546112 @20: 0.10863617364293507 @40: 0.14316812209166258
2021-01-31 20:12:45,278 - root - INFO - epoch 81 train loss: -2033.009920
2021-01-31 20:12:51,007 - root - INFO - epoch 82 train loss: -2034.861734
2021-01-31 20:12:56,019 - root - INFO - epoch 83 train loss: -2034.652270
2021-01-31 20:13:00,151 - root - INFO - epoch 84 train loss: -2035.471500
2021-01-31 20:13:06,173 - root - INFO - epoch 85 train loss: -2035.026532
2021-01-31 20:13:06,173 - root - INFO - epoch 85 evaluating ...
2021-01-31 20:14:58,024 - root - INFO -     [test] epoch 85 Recall @10: 0.045668749118002214 @20: 0.07519589060727198 @40: 0.12101013992867118
2021-01-31 20:14:58,025 - root - INFO -     [test] epoch 85 NDCG @10: 0.08102562026361687 @20: 0.10846322474592249 @40: 0.1432807311037855
2021-01-31 20:14:58,025 - root - INFO - early-stop at epoch 85
2021-01-31 20:14:58,025 - root - INFO - max Recall@10: 0.04570517499860224 at epoch 50
2021-01-31 20:14:58,025 - root - INFO - max Recall@20: 0.07568781033433719 at epoch 75
2021-01-31 20:14:58,025 - root - INFO - max Recall@40: 0.12122424530345102 at epoch 60
2021-01-31 20:14:58,025 - root - INFO - max NDCG@10: 0.08111772708521102 at epoch 60
2021-01-31 20:14:58,025 - root - INFO - max NDCG@20: 0.10866265716530937 at epoch 60
2021-01-31 20:14:58,026 - root - INFO - max NDCG@40: 0.14341352244007557 at epoch 60
